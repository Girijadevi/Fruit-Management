<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<br>
<div class="header" style="font-size: xx-large; text-align: center;"><b>Fresh Fruit Mart</b></div>
<div style="margin-top: 18px;">
<form #myForm="ngForm" class="form-group">
  <div class="input-group" style="margin-left: 7px; width:fit-content;">
    <form class="searchBar">
      <input id="search-text" aria-describedby="search-text" type="search" placeholder="Search..." class="searchTerm form-control rounded-pill" name="searchTerm" [(ngModel)]="searchTerm" (input)="filterFruits()">
    </form>
</div>
<div style="margin-bottom: -10px;">
  <div class="button-container" style="display: inline-block;">
    <button type="button" routerLink="/create" routerLinkActive="active" style="margin-top: -65px; margin-left: 
    239px;" class="btn btn-primary">Create</button>
  </div>
  <div class="button-container" style="display: inline-block;">
    <button type="button" (click)="triggerMultiple()" data-toggle="modal" data-target="#helloModal" style="margin-left: 8px; margin-top: -65px;" class="btn btn-danger">Delete Selected Records</button>
  </div>
</div>
<div class="table-container">
<table class="table" style="border-color: black; margin-left: 1px;">
  <thead style="border-bottom-width: medium;">
      <tr>
        <th><input type="checkbox" #selectAllCheckbox (change)="toggleSelectAll()"></th>
        <th>Id
        </th>
        <th (click)="sortFruitsBy('name')">
          Name
          <i *ngIf="sortDirections['name'] === 'asc'" class="fa fa-sort-asc" aria-hidden="true"></i>
          <i *ngIf="sortDirections['name'] === 'desc'" class="fa fa-sort-desc" aria-hidden="true"></i>
        </th>
        <th (click)="sortFruitsBy('quantity')">
          Quantity
          <i *ngIf="sortDirections['quantity'] === 'asc'" class="fa fa-sort-asc" aria-hidden="true"></i>
          <i *ngIf="sortDirections['quantity'] === 'desc'" class="fa fa-sort-desc" aria-hidden="true"></i>
        </th>
        <th (click)="sortFruitsBy('price')">
          Price
          <i *ngIf="sortDirections['price'] === 'asc'" class="fa fa-sort-asc" aria-hidden="true"></i>
          <i *ngIf="sortDirections['price'] === 'desc'" class="fa fa-sort-desc" aria-hidden="true"></i>
        </th>
        <th >Actions</th>
      </tr>
  </thead>
      <tbody>
          <tr *ngFor="let frt of paginatedItems, let id=index;" >
          <td><input type="checkbox" [checked]="frt.selected" (change)="toggleCheckbox(id)"></td>
          <td >{{id+1}}</td>
          <td *ngIf="!isEditable(frt.id)">{{frt.name}}</td>
          <td *ngIf="isEditable(frt.id)">
          <input type="text" [(ngModel)]="frt.name" [disabled]="!isEditable(frt.id)" name ="name">
          </td>
          <td *ngIf="!isEditable(frt.id)" >{{frt.quantity}}</td>
          <td *ngIf="isEditable(frt.id)">
          <input type="number" [(ngModel)]="frt.quantity" [disabled]="!isEditable(frt.id)" name ="quantity">
          </td>
          <td *ngIf="!isEditable(frt.id)" >{{frt.price}}</td>
          <td *ngIf="isEditable(frt.id)">
          <input type="number" [(ngModel)]="frt.price" [disabled]="!isEditable(frt.id)" name ="price">
          </td>
          <td>
            <div *ngIf="!isEditable(frt.id)">
              <i type="button" class="fa fa-pencil-square-o" aria-hidden="true" (click)="editFruits(frt)"></i>
              <i type="button" id="{{frt.id}}" class="fa fa-trash-o px-3"  aria-hidden="true" (click)="trigger(frt.id)" data-toggle="modal" data-target="#helloModal"></i>
            </div>
            <div *ngIf="isEditable(frt.id)">
              <i type="button" class="fa fa-cloud" (click)="updateFruits(frt.id, frt)" aria-hidden="true"></i>
              <i type="button" class="fa fa-times-circle px-3" aria-hidden="true" (click)="onCancel(frt)"></i>
            </div>
         </td>
   </tr> 
    </tbody>
  </table>
   <!-- Pagination -->
<div class="pagination justify-content-center">
  <ul class="pagination">
    <li class="page-item" [class.disabled]="currentPage === 1">
      <a class="page-link" (click)="onPageChange(currentPage - 1)" href="#" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>
    <li class="page-item" *ngFor="let page of totalPages" [class.active]="page === currentPage">
      <a class="page-link" (click)="onPageChange(page)" href="#" *ngIf="currentPage >= page - 1 && currentPage <= page + 1">
        {{ page }}
      </a>
    </li>
    <li class="page-item" [class.disabled]="currentPage === totalPages.length">
      <a class="page-link" (click)="onPageChange(currentPage + 1)" href="#" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
  </ul>
</div>
  </div>
  </form>

  <router-outlet></router-outlet>

   <!-- Delete Modal Starts here -->
  
   <div #helloModal class="modal fade" id="helloModal" role="dialog" aria-labelledby="helloModalLabel" aria-hidden="true">
   
    <div class="modal-dialog" role="document" >
      <div class="modal-content" >
        <div class="modal-header">
          <h5 class="modal-title" style="font-size: large;" id="helloModalLabel"><b>Warning!</b></h5>
          <button (click)="triggerReset()" type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          Are you sure to delete?
        </div>
        <div class="modal-footer">
          <button (click)="triggerReset()" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-danger" (click)="deleteFruits()">Confirm Delete
          </button>
        </div>
      </div>
    </div>
</div>



